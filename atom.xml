<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>柳英伟博客</title>
  
  <subtitle>柳英伟博客</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://marvin9002.github.com/"/>
  <updated>2018-03-31T11:21:24.941Z</updated>
  <id>http://marvin9002.github.com/</id>
  
  <author>
    <name>柳英伟</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>PHP面试知识梳理</title>
    <link href="http://marvin9002.github.com/2018/03/31/PHP%E9%9D%A2%E8%AF%95%E7%9F%A5%E8%AF%86%E6%A2%B3%E7%90%86/"/>
    <id>http://marvin9002.github.com/2018/03/31/PHP面试知识梳理/</id>
    <published>2018-03-31T09:55:04.000Z</published>
    <updated>2018-03-31T11:21:24.941Z</updated>
    
    <content type="html"><![CDATA[<p>昨天在思否上发了这篇整理，晚上10点多看到了很多赞收藏和关注，其实挺愧疚的，<br>因为最近在找工作这篇文章并没有整理完。<br>看到这个还挺受欢迎的，也因为新工作基本定下来了，<br>现在的公司正常交接中，打算下周末之前把这个知识梳理整理完，<br>感谢各位的点赞、收藏和关注，大家一起努力。</p><a id="more"></a><h1 id="算法与数据结构"><a href="#算法与数据结构" class="headerlink" title="算法与数据结构"></a>算法与数据结构</h1><h3 id="BTree和B-tree"><a href="#BTree和B-tree" class="headerlink" title="BTree和B+tree"></a>BTree和B+tree</h3><ul><li><p>BTree</p><p>  B树是为了磁盘或者其他存储设备而设计的一种多叉平衡查找树，相对于二叉树，B树的每个内节点有多个分支，即多叉。<br>  参考文章：<a href="https://www.jianshu.com/p/da59af78ec59" target="_blank" rel="noopener">https://www.jianshu.com/p/da59af78ec59</a></p></li><li><p>B+Tree</p><p>  B+树是B树的变体，也是一种多路搜索树。<br>  参考文章：<a href="https://www.jianshu.com/p/da59af78ec59" target="_blank" rel="noopener">https://www.jianshu.com/p/da59af78ec59</a></p></li></ul><h3 id="排序算法"><a href="#排序算法" class="headerlink" title="排序算法"></a>排序算法</h3><ul><li><p>快速排序</p><p>  快速排序是十分常用的高效率的算法，其思想是：先选一个标尺，用它把整个队列过一遍筛选，以保证其左边的元素都不大于它，其右边的元素都不小与它</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">function quickSort($arr)&#123;</span><br><span class="line"></span><br><span class="line">  // 获取数组长度</span><br><span class="line">  $length = count($arr);</span><br><span class="line"></span><br><span class="line">  // 判断长度是否需要继续二分比较</span><br><span class="line">  if($length &lt;= 1)&#123;</span><br><span class="line">    return $arr;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 定义基准元素</span><br><span class="line">  $base = $arr[0];</span><br><span class="line"></span><br><span class="line">  // 定义两个空数组，用于存放和基准元素的比较后的结果</span><br><span class="line">  $left = [];</span><br><span class="line">  $right = [];</span><br><span class="line"></span><br><span class="line">  // 遍历数组</span><br><span class="line">  for ($i=1; $i &lt; $length; $i++) &#123; </span><br><span class="line"></span><br><span class="line">    // 和基准元素作比较</span><br><span class="line">    if ($arr[$i] &gt; $base) &#123;</span><br><span class="line">      $right[] = $arr[$i];</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">      $left[] = $arr[$i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 然后递归分别处理left和right</span><br><span class="line">  $left = quickSort($left);</span><br><span class="line">  $right = quickSort($right);</span><br><span class="line"></span><br><span class="line">  // 合并</span><br><span class="line">  return array_merge($left,[$base],$right);</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>冒泡排序</p><p>思路：法如其名，就像冒泡一样，每次从数组中冒出一个最大的数<br>比如：2，4，1<br>第一次冒出4：2，1，4<br>第二次冒出2：1，2，4</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function bubbleSort($arr)&#123;</span><br><span class="line"></span><br><span class="line">  // 获取数组长度</span><br><span class="line">  $length = count($arr);</span><br><span class="line"></span><br><span class="line">  // 第一层循环控制冒泡轮次</span><br><span class="line">  for ($i=0; $i &lt; $length-1; $i++) &#123; </span><br><span class="line">    </span><br><span class="line">    // 内层循环控制从第0个键值和后一个键值比较，每次冒出一个最大的数</span><br><span class="line">    for ($k=0; $k &lt; $length-$i-1; $k++) &#123; </span><br><span class="line">      if($arr[$k] &gt; $arr[$k+1])&#123;</span><br><span class="line">        $tmp = $arr[$k+1];</span><br><span class="line">        $arr[$k+1] = $arr[$k];</span><br><span class="line">        $arr[$k] = $tmp;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return $arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>选择排序</li></ul><p>思路：每次选择一个相应的元素，然后将其放到指定的位置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">function selectSort($arr)&#123;</span><br><span class="line"> </span><br><span class="line">  // 实现思路</span><br><span class="line">  // 双重循环完成，外层控制轮数，当前的最小值，内层控制比较次数</span><br><span class="line"></span><br><span class="line">  // 获取长度</span><br><span class="line">  $length = count($arr);</span><br><span class="line">  </span><br><span class="line">  for ($i=0; $i &lt; $length - 1; $i++) &#123; </span><br><span class="line">    // 假设最小值的位置</span><br><span class="line">    $p = $i;</span><br><span class="line">  </span><br><span class="line">    // 使用假设的最小值和其他值比较，找到当前的最小值</span><br><span class="line">    for ($j=$i+1; $j &lt; $length; $j++) &#123; </span><br><span class="line">      // $arr[$p] 是已知的当前最小值</span><br><span class="line">  </span><br><span class="line">      // 判断当前循环值和已知最小值的比较，当发下更小的值时记录下键，并进行下一次比较</span><br><span class="line">      if ($arr[$p] &gt; $arr[$j]) &#123;</span><br><span class="line">        $p = $j; // 比假设的值更小</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    // 通过内部for循环找到了当前最小值的key,并保存在$p中</span><br><span class="line">    // 判断 日光当前$p 中的键和假设的最小值的键不一致增将其互换</span><br><span class="line">    if ($p != $i) &#123;</span><br><span class="line">      $tmp = $arr[$p];</span><br><span class="line">      $arr[$p] = $arr[$i];</span><br><span class="line">      $arr[$i] = $tmp;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  // 返回最终结果</span><br><span class="line">  return $arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h1><h3 id="TCP-UDP区别"><a href="#TCP-UDP区别" class="headerlink" title="TCP/UDP区别"></a>TCP/UDP区别</h3><ul><li><p>TCP </p><p>TCP是一种面向连接的、可靠的、基于字节流的传输层通信协议<br>TCP面向连接，提供可靠地数据服务<br>TCP首部开销20字节<br>TCP逻辑通信信道是全双工的可靠信道<br>TCP连接只能是点到点的</p></li><li><p>UDP</p><p>UDP是参考模型中一种无连接的传输层协议，提供面向事务的简单不可靠的信息传递服务<br>UDP无连接，不可靠<br>UDP首部开销8字节<br>UDP逻辑通信信道是不可靠信道<br>UDP没有拥塞机制，因此网络出现拥堵不会使源主机的发送效率降低<br>UDP支持一对一，多对一，多对多的交互通信</p></li></ul><h3 id="三次握手，四次挥手，为什么是三次握手四次挥手"><a href="#三次握手，四次挥手，为什么是三次握手四次挥手" class="headerlink" title="三次握手，四次挥手，为什么是三次握手四次挥手"></a>三次握手，四次挥手，为什么是三次握手四次挥手</h3><p>在TCP/IP协议中,TCP协议提供可靠的连接服务,采用三次握手建立一个连接，完成三次握手,客户端与服务器开始传送数据。<br>简单点说：A与B建立TCP连接时，首先A向B发送SYN（同步请求），然后B回复SYN+ACK（同步请求应答），最后A回复ACK确认，这样TCP的一次连接（三次握手）就完成了。</p><ul><li>TCP三次握手</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">所谓三次握手，是指简历一个TCP连接时需要客户端和服务器总共发送三个包</span><br><span class="line">三次握手的目的是连接服务器指定端口，简历TCP连接，并同步连接双方的序列号并交换TCP窗口大小信息。</span><br><span class="line">TCP三次握手图解：</span><br><span class="line">https://segmentfault.com/img/remote/1460000013696436?w=714&amp;h=537</span><br></pre></td></tr></table></figure><p>第一次握手<br>客户端发送一个TCP的SYN标志位置1的包，指明客户打算连接的服务器的端口，以及初始化序号，保存在包头的序列号字段里<br>第二次握手<br>服务器发挥确认包应答，即SYN标志位和ACK标志均为1，同时将确认序号设置为客户的ISN加1，即X+1<br>第三次握手<br>客户端再次发送确认包，SYN标识为0，ACK标识为1，并且把服务器发来的序号字段+1，放在确定字段中发送给对方，并且在数据字段写入ISN的+1<br>简单解释TCP三次握手：<br>参考：<a href="https://github.com/jawil/blog.." target="_blank" rel="noopener">https://github.com/jawil/blog..</a>.</p>]]></content>
    
    <summary type="html">
    
      周末之前把这个知识梳理整理完，感谢各位的点赞、收藏和关注，大家一起努力。
    
    </summary>
    
      <category term="后端" scheme="http://marvin9002.github.com/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
      <category term="PHP" scheme="http://marvin9002.github.com/tags/PHP/"/>
    
      <category term="面试" scheme="http://marvin9002.github.com/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="算法" scheme="http://marvin9002.github.com/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="网络" scheme="http://marvin9002.github.com/tags/%E7%BD%91%E7%BB%9C/"/>
    
      <category term="设计模式" scheme="http://marvin9002.github.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>python +splinter自动刷新抢票</title>
    <link href="http://marvin9002.github.com/2018/03/31/python-splinter%E8%87%AA%E5%8A%A8%E5%88%B7%E6%96%B0%E6%8A%A2%E7%A5%A8/"/>
    <id>http://marvin9002.github.com/2018/03/31/python-splinter自动刷新抢票/</id>
    <published>2018-03-31T09:48:09.000Z</published>
    <updated>2018-03-31T09:53:13.985Z</updated>
    
    <content type="html"><![CDATA[<p>一年一度的春运又来了，</p><p>今年我自己写了个抢票脚本。</p><p>python +splinter自动刷新抢票，可以成功抢到（依赖自己的网络环境太厉害，还有机器的好坏），</p><p>但是感觉不是很完美!</p><a id="more"></a><p>有大神请指导完善一下（或者有没有别的好点的思路）</p><p>不胜感谢</p><p>废话不多说，代码帅上来!</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">@author: liuyw</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">from splinter.browser import Browser</span><br><span class="line">from time import sleep</span><br><span class="line">import traceback</span><br><span class="line">import time, sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class huoche(object):</span><br><span class="line">&quot;&quot;&quot;docstring for huoche&quot;&quot;&quot;</span><br><span class="line">driver_name=&apos;&apos;</span><br><span class="line">executable_path=&apos;&apos;</span><br><span class="line">#用户名，密码</span><br><span class="line">username = u&quot;xxx@qq.com&quot;</span><br><span class="line">passwd = u&quot;xxxx&quot;</span><br><span class="line"># cookies值得自己去找, 下面两个分别是上海, 太原南</span><br><span class="line">starts = u&quot;%u4E0A%u6D77%2CSHH&quot;</span><br><span class="line">ends = u&quot;%u592A%u539F%2CTYV&quot;</span><br><span class="line"># 时间格式2018-01-19</span><br><span class="line">dtime = u&quot;2018-01-19&quot;</span><br><span class="line"># 车次，选择第几趟，0则从上之下依次点击</span><br><span class="line">order = 0</span><br><span class="line">###乘客名</span><br><span class="line">users = [u&quot;xxx&quot;,u&quot;xxx&quot;]</span><br><span class="line">##席位</span><br><span class="line">xb = u&quot;二等座&quot;</span><br><span class="line">pz=u&quot;成人票&quot;</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;网址&quot;&quot;&quot;</span><br><span class="line">ticket_url = &quot;https://kyfw.12306.cn/otn/leftTicket/init&quot;</span><br><span class="line">login_url = &quot;https://kyfw.12306.cn/otn/login/init&quot;</span><br><span class="line">initmy_url = &quot;https://kyfw.12306.cn/otn/index/initMy12306&quot;</span><br><span class="line">buy=&quot;https://kyfw.12306.cn/otn/confirmPassenger/initDc&quot;</span><br><span class="line">login_url=&apos;https://kyfw.12306.cn/otn/login/init&apos;</span><br><span class="line">def __init__(self):</span><br><span class="line">self.driver_name=&apos;chrome&apos;</span><br><span class="line">self.executable_path=&apos;/usr/local/bin/chromedriver&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def login(self):</span><br><span class="line">self.driver.visit(self.login_url)</span><br><span class="line">self.driver.fill(&quot;loginUserDTO.user_name&quot;, self.username)</span><br><span class="line"># sleep(1)</span><br><span class="line">self.driver.fill(&quot;userDTO.password&quot;, self.passwd)</span><br><span class="line">print u&quot;等待验证码，自行输入...&quot;</span><br><span class="line">while True:</span><br><span class="line">if self.driver.url != self.initmy_url:</span><br><span class="line">sleep(1)</span><br><span class="line">else:</span><br><span class="line">break</span><br><span class="line"></span><br><span class="line">def start(self):</span><br><span class="line">self.driver=Browser(driver_name=self.driver_name,executable_path=self.executable_path)</span><br><span class="line">self.driver.driver.set_window_size(1400, 1000)</span><br><span class="line">self.login()</span><br><span class="line"># sleep(1)</span><br><span class="line">self.driver.visit(self.ticket_url)</span><br><span class="line">try:</span><br><span class="line">print u&quot;购票页面开始...&quot;</span><br><span class="line"># sleep(1)</span><br><span class="line"># 加载查询信息</span><br><span class="line">self.driver.cookies.add(&#123;&quot;_jc_save_fromStation&quot;: self.starts&#125;)</span><br><span class="line">self.driver.cookies.add(&#123;&quot;_jc_save_toStation&quot;: self.ends&#125;)</span><br><span class="line">self.driver.cookies.add(&#123;&quot;_jc_save_fromDate&quot;: self.dtime&#125;)</span><br><span class="line"></span><br><span class="line">self.driver.reload()</span><br><span class="line"></span><br><span class="line">count=0</span><br><span class="line">if self.order!=0:</span><br><span class="line">while self.driver.url==self.ticket_url:</span><br><span class="line">self.driver.find_by_text(u&quot;查询&quot;).click()</span><br><span class="line">count += 1</span><br><span class="line">print u&quot;循环点击查询... 第 %s 次&quot; % count</span><br><span class="line"># sleep(1)</span><br><span class="line">try:</span><br><span class="line">self.driver.find_by_text(u&quot;预订&quot;)[self.order - 1].click()</span><br><span class="line">except Exception as e:</span><br><span class="line">print e</span><br><span class="line">print u&quot;还没开始预订&quot;</span><br><span class="line">continue</span><br><span class="line">else:</span><br><span class="line">while self.driver.url == self.ticket_url:</span><br><span class="line">self.driver.find_by_text(u&quot;查询&quot;).click()</span><br><span class="line">count += 1</span><br><span class="line">print u&quot;循环点击查询... 第 %s 次&quot; % count</span><br><span class="line"># sleep(0.8)</span><br><span class="line">try:</span><br><span class="line">for i in self.driver.find_by_text(u&quot;预订&quot;):</span><br><span class="line">i.click()</span><br><span class="line">sleep(1)</span><br><span class="line">except Exception as e:</span><br><span class="line">print e</span><br><span class="line">print u&quot;还没开始预订 %s&quot; %count</span><br><span class="line">continue</span><br><span class="line">print u&quot;开始预订...&quot;</span><br><span class="line"># sleep(3)</span><br><span class="line"># self.driver.reload()</span><br><span class="line">sleep(1)</span><br><span class="line">print u&apos;开始选择用户...&apos;</span><br><span class="line">for user in self.users:</span><br><span class="line">self.driver.find_by_text(user).last.click()</span><br><span class="line"></span><br><span class="line">print u&quot;提交订单...&quot;</span><br><span class="line">sleep(1)</span><br><span class="line"># self.driver.find_by_text(self.pz).click()</span><br><span class="line"># self.driver.find_by_id(&apos;&apos;).select(self.pz)</span><br><span class="line"># # sleep(1)</span><br><span class="line"># self.driver.find_by_text(self.xb).click()</span><br><span class="line"># sleep(1)</span><br><span class="line">self.driver.find_by_id(&apos;submitOrder_id&apos;).click()</span><br><span class="line"># print u&quot;开始选座...&quot;</span><br><span class="line"># self.driver.find_by_id(&apos;1D&apos;).last.click()</span><br><span class="line"># self.driver.find_by_id(&apos;1F&apos;).last.click()</span><br><span class="line"></span><br><span class="line">sleep(1.5)</span><br><span class="line">print u&quot;确认选座...&quot;</span><br><span class="line">self.driver.find_by_id(&apos;qr_submit_id&apos;).click()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">except Exception as e:</span><br><span class="line">print e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">huoche=huoche()</span><br><span class="line">huoche.start()</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      一年一度的春运又来了，今年我自己写了个抢票脚本。python +splinter自动刷新抢票，可以成功抢到（依赖自己的网络环境太厉害，还有机器的好坏），但是感觉不是很完美，有大神请指导完善一下（或者有没有别的好点的思路）不胜感谢
    
    </summary>
    
      <category term="后端" scheme="http://marvin9002.github.com/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
      <category term="python" scheme="http://marvin9002.github.com/tags/python/"/>
    
      <category term="splinter" scheme="http://marvin9002.github.com/tags/splinter/"/>
    
      <category term="火车票" scheme="http://marvin9002.github.com/tags/%E7%81%AB%E8%BD%A6%E7%A5%A8/"/>
    
  </entry>
  
  <entry>
    <title>PHP高效导出Excel(CSV)</title>
    <link href="http://marvin9002.github.com/2018/03/31/PHP%E9%AB%98%E6%95%88%E5%AF%BC%E5%87%BAExcel-CSV/"/>
    <id>http://marvin9002.github.com/2018/03/31/PHP高效导出Excel-CSV/</id>
    <published>2018-03-31T09:04:05.000Z</published>
    <updated>2018-03-31T10:14:58.890Z</updated>
    
    <content type="html"><![CDATA[<p>CSV，是Comma Separated Value（逗号分隔值）的英文缩写，通常都是纯文本文件。<br>如果你导出的Excel没有什么高级用法的话，只是做导出数据用那么建议使用本方法,要比PHPexcel要高效的多。<br>二十万数据导出大概需要2到3秒。</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"> /**</span><br><span class="line"> * 导出excel(csv)</span><br><span class="line"> * @data 导出数据</span><br><span class="line"> * @headlist 第一行,列名</span><br><span class="line"> * @fileName 输出Excel文件名</span><br><span class="line"> */</span><br><span class="line">function csv_export($data = array(), $headlist = array(), $fileName) &#123;</span><br><span class="line">  </span><br><span class="line">    header(&apos;Content-Type: application/vnd.ms-excel&apos;);</span><br><span class="line">    header(&apos;Content-Disposition: attachment;filename=&quot;&apos;.$fileName.&apos;.csv&quot;&apos;);</span><br><span class="line">    header(&apos;Cache-Control: max-age=0&apos;);</span><br><span class="line">  </span><br><span class="line">    //打开PHP文件句柄,php://output 表示直接输出到浏览器</span><br><span class="line">    $fp = fopen(&apos;php://output&apos;, &apos;a&apos;);</span><br><span class="line">    </span><br><span class="line">    //输出Excel列名信息</span><br><span class="line">    foreach ($headlist as $key =&gt; $value) &#123;</span><br><span class="line">        //CSV的Excel支持GBK编码，一定要转换，否则乱码</span><br><span class="line">        $headlist[$key] = iconv(&apos;utf-8&apos;, &apos;gbk&apos;, $value);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    //将数据通过fputcsv写到文件句柄</span><br><span class="line">    fputcsv($fp, $headlist);</span><br><span class="line">    </span><br><span class="line">    //计数器</span><br><span class="line">    $num = 0;</span><br><span class="line">    </span><br><span class="line">    //每隔$limit行，刷新一下输出buffer，不要太大，也不要太小</span><br><span class="line">    $limit = 100000;</span><br><span class="line">    </span><br><span class="line">    //逐行取出数据，不浪费内存</span><br><span class="line">    $count = count($data);</span><br><span class="line">    for ($i = 0; $i &lt; $count; $i++) &#123;</span><br><span class="line">    </span><br><span class="line">        $num++;</span><br><span class="line">        </span><br><span class="line">        //刷新一下输出buffer，防止由于数据过多造成问题</span><br><span class="line">        if ($limit == $num) &#123; </span><br><span class="line">            ob_flush();</span><br><span class="line">            flush();</span><br><span class="line">            $num = 0;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        $row = $data[$i];</span><br><span class="line">        foreach ($row as $key =&gt; $value) &#123;</span><br><span class="line">            $row[$key] = iconv(&apos;utf-8&apos;, &apos;gbk&apos;, $value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        fputcsv($fp, $row);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      CSV，是Comma Separated Value（逗号分隔值）的英文缩写，通常都是纯文本文件。
    
    </summary>
    
      <category term="后端" scheme="http://marvin9002.github.com/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
      <category term="PHP" scheme="http://marvin9002.github.com/tags/PHP/"/>
    
      <category term="CSV" scheme="http://marvin9002.github.com/tags/CSV/"/>
    
  </entry>
  
</feed>
